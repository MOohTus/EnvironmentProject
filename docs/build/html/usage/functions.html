
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Functions &#8212; EnvironmentProject 1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Quickstart" href="Quickstart.html" />
    <link rel="prev" title="Welcome to EnvironmentProject’s documentation!" href="../index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-mainScript_click">
<span id="functions"></span><h1>Functions<a class="headerlink" href="#module-mainScript_click" title="Permalink to this headline">¶</a></h1>
<p>&#64;author: Morgane T.</p>
<p>Main script
Using click for argument parsing
Analysis calling</p>
<span class="target" id="module-methods_functions"></span><p>&#64;author: Morgane T. and Ozan O.</p>
<p>Script of methods that we can apply to CTD and WP lists
Adapted from overlapAnalysis.py from Ozan O. (Paper vitamin A)</p>
<dl class="py function">
<dt class="sig sig-object py" id="methods_functions.RWR">
<span class="sig-prename descclassname"><span class="pre">methods_functions.</span></span><span class="sig-name descname"><span class="pre">RWR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configPath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">networksPath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputPath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sifPathName</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#methods_functions.RWR" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a Random Walk with Restart analysis on different multiplex and networks.
You have to specify seeds and networks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>configPath</strong> (<em>str</em>) – Configuration file name path</p></li>
<li><p><strong>networksPath</strong> (<em>str</em>) – Networks path name</p></li>
<li><p><strong>outputPath</strong> (<em>str</em>) – Output folder path name</p></li>
<li><p><strong>sifPathName</strong> (<em>str</em>) – Result file name path to write SIF result file</p></li>
<li><p><strong>top</strong> (<em>int</em>) – Number of results to report in SIF file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="methods_functions.overlap">
<span class="sig-prename descclassname"><span class="pre">methods_functions.</span></span><span class="sig-name descname"><span class="pre">overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">targetGeneSet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">WPGenesDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">WPBackgroundGenesSet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chemNames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">WPDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputPath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#methods_functions.overlap" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate overlap between target genes and Rase Diseases WP</p>
<dl class="simple">
<dt>Metrics :</dt><dd><ul class="simple">
<li><p>M is the population size (Nb of genes inside WikiPathway for Homo sapiens pathways)</p></li>
<li><p>n is the number of successes in the population (Nb of genes inside the selected RD WP)</p></li>
<li><p>N is the sample size (Nb of genes shared between target list (from chemical) and background genes from WP)</p></li>
<li><p>x is the number of drawn “successes” (Nb of genes shared between target list and RD WP)</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>targetGeneSet</strong> (<em>set</em>) – Set of HGNC targets</p></li>
<li><p><strong>WPGenesDict</strong> (<em>dict</em>) – Dictionary of Rare Diseases WP</p></li>
<li><p><strong>WPBackgroundGenesSet</strong> (<em>set</em>) – Set of all HGNC inside WikiPathway for Homo sapiens</p></li>
<li><p><strong>chemNames</strong> (<em>str</em>) – MeSH ID of chemical of interest</p></li>
<li><p><strong>WPDict</strong> (<em>dict</em>) – Dictionary of WP composed of title of them</p></li>
<li><p><strong>outputPath</strong> (<em>str</em>) – Folder path to save the results</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – Data frame of overlap metrics for each rare diseases WP</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="methods_functions.overlapAnalysis">
<span class="sig-prename descclassname"><span class="pre">methods_functions.</span></span><span class="sig-name descname"><span class="pre">overlapAnalysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chemTargetsDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">WPGeneRDDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">WPBackgroundGenes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">WPDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputPath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#methods_functions.overlapAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>For each chemical given in input, calculate overlap with RD WP.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chemTargetsDict</strong> (<em>dict</em>) – Dict composed of interaction genes list for each chemical</p></li>
<li><p><strong>WPGeneRDDict</strong> (<em>dict</em>) – Dictionary of Rare Diseases WP</p></li>
<li><p><strong>WPBackgroundGenes</strong> (<em>list</em>) – List of uniq genes found in Homo sapiens WP</p></li>
<li><p><strong>WPDict</strong> (<em>dict</em>) – Dict of titles for each RD WikiPathway</p></li>
<li><p><strong>outputPath</strong> (<em>str</em>) – Folder path to save the results</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-CTD_functions"></span><p>&#64;author: Morgane T.</p>
<p>CTD functions</p>
<dl class="py function">
<dt class="sig sig-object py" id="CTD_functions.CTDrequest">
<span class="sig-prename descclassname"><span class="pre">CTD_functions.</span></span><span class="sig-name descname"><span class="pre">CTDrequest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chemName</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">association</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputPath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbPub</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CTD_functions.CTDrequest" title="Permalink to this definition">¶</a></dt>
<dd><p>Function requests CTD database.</p>
<p>Search all genes which interact with the chemical given in input.
Could be several chemicals names. Analysis will be done like if it’s only one chemical.
If hierarchicalAssociations is used, chemical related to the chemical given in input are used as query.
Focus on genes present in Homo sapiens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chemName</strong> (<em>str</em>) – chemical name of MeSH ids string</p></li>
<li><p><strong>association</strong> (<em>str</em>) – association name (hierarchicalAssociations or directAssociations)</p></li>
<li><p><strong>outputPath</strong> (<em>str</em>) – Folder path to save the results</p></li>
<li><p><strong>nbPub</strong> (<em>int</em>) – Number of references needed to keep an interaction</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>homoGenesList</strong> (<em>list</em>) – List of genes which interact with chemicals given in input (only Homo sapiens)</p></li>
<li><p><strong>chemMeSH</strong> (<em>str</em>) – Composition of MeSH ID from chemicals given in input</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CTD_functions.CTDrequestFromList">
<span class="sig-prename descclassname"><span class="pre">CTD_functions.</span></span><span class="sig-name descname"><span class="pre">CTDrequestFromList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chemList</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">association</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputPath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbPub</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CTD_functions.CTDrequestFromList" title="Permalink to this definition">¶</a></dt>
<dd><p>Make CTD request for each chemical present in the list given in input.
Each element can be composed of one or more element.
If several element, the analysis will be done like if there is only one chemical.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chemList</strong> (<em>list</em>) – List of chemical to request to CTD (MeSH IDs or chemical names)</p></li>
<li><p><strong>association</strong> (<em>str</em>) – association name (hierarchicalAssociations or directAssociations)</p></li>
<li><p><strong>outputPath</strong> (<em>str</em>) – Folder path to save the results</p></li>
<li><p><strong>nbPub</strong> (<em>int</em>) – Number of references needed to keep an interaction</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>chemTargetsDict</strong> (<em>dict</em>) – Dict composed of interaction genes list for each chemical</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CTD_functions.targetExtraction">
<span class="sig-prename descclassname"><span class="pre">CTD_functions.</span></span><span class="sig-name descname"><span class="pre">targetExtraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">CTDFile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directAssociations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputPath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbPub</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CTD_functions.targetExtraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Read environmental factor file
Request CTD and extract target genes
Save results into output file
Return the gene targets list</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>argsDict</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-WP_functions"></span><p>&#64;author: Morgane T.</p>
<p>WikiPathways functions</p>
<p>EnvironmentalProject’s doctrings</p>
<dl class="py function">
<dt class="sig sig-object py" id="WP_functions.allGenesFromWP">
<span class="sig-prename descclassname"><span class="pre">WP_functions.</span></span><span class="sig-name descname"><span class="pre">allGenesFromWP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outputPath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#WP_functions.allGenesFromWP" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract all gene HGNC ID from Homo sapiens WP.
Write request result into output file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>outputPath</strong> (<em>str</em>) – Folder path to save the results</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>geneSetWP</strong> (<em>list</em>) – List of uniq genes found in Homo sapiens WP</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="WP_functions.rareDiseasesWPrequest">
<span class="sig-prename descclassname"><span class="pre">WP_functions.</span></span><span class="sig-name descname"><span class="pre">rareDiseasesWPrequest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outputPath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#WP_functions.rareDiseasesWPrequest" title="Permalink to this definition">¶</a></dt>
<dd><p>Function requests WikiPathway database.</p>
<p>Search all WikiPathways related to Rare Diseases.
Focus on pathways related with Homo sapiens.
Write results into result file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>outputPath</strong> (<em>str</em>) – Folder path to save the results</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>genesDict</strong> (<em>dictionary</em>) – Dict of genes for each RD WikiPathway</p></li>
<li><p><strong>WPDict</strong> (<em>dictionary</em>) – Dict of titles for each RD WikiPathway</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="WP_functions.readRequestResultsWP">
<span class="sig-prename descclassname"><span class="pre">WP_functions.</span></span><span class="sig-name descname"><span class="pre">readRequestResultsWP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#WP_functions.readRequestResultsWP" title="Permalink to this definition">¶</a></dt>
<dd><p>Read request from WP.
Parse and extract information from request.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>request</strong> (<em>bytes</em>) – request from WikiPathway</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>dictionary</strong> (<em>dictionary</em>) – Dict of genes for each WikiPathway</p></li>
<li><p><strong>WPdictionary</strong> (<em>dictionary</em>) – Dict of titles for each WikiPathway</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">EnvironmentProject</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Quickstart.html">Quickstart</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../index.html" title="previous chapter">Welcome to EnvironmentProject’s documentation!</a></li>
      <li>Next: <a href="Quickstart.html" title="next chapter">Quickstart</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Térézol.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.3.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/usage/functions.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>